<%- include('layout/header');%>



  <!-- Main Content -->
  <div class="content">
    <div class="bg-blue-500 w-full sm:w-1/3 p-4">
      <!-- form -->
      <form class="md:flex-2/3 p-4 " action="/add" method="POST">
        <div class="bg-blue-200 p-4 rounded-lg">
          <div class="mb-5">
            <div class="mb-5">
              <label for="platform"
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Platform</label>
              <input type="text" id="platform"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                placeholder="Platform Name" name="platform" required />
            </div>
            <label for="course" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Enter
              Your Course Name</label>
            <input
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              type="text" name="course" placeholder="Course name" required>
            <span class="focus-border">
              <i></i>
            </span>
          </div>
          <div class="mb-5">
            <label for="instructor name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Instructed
              by</label>
            <input
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              type="text" name="name" placeholder="Instructor name" required>
            <span class="focus-border">
              <i></i>
            </span>
          </div>
          <div class="mb-5">
            <label for="Enrolled date" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Enter
              Enter Your Enrolled Date </label>
            <input
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              type="date" name="date" placeholder="Date enrolled" required>
            <span class="focus-border">
              <i></i>
            </span>
          </div>
          <div class="mb-5">
            <div id="fourth" class="buttonBox">
              <button
                class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
                type="submit">Register Courses</button>

            </div>
          </div>
        </div>

      </form>
    </div>
    <!-- result in accordion style -->
    <div class="bg-slate-200 w-full sm:w-2/3 p-4 main-section overflow-y-auto">
      <div id="accordion" class="" data-accordion="collapse">
        <% todo.forEach((todo, index)=> { %>
          <div class="border border-gray-400 rounded">
            <h2 id="accordion-heading-<%= index %>">
              <button type="button"
                class="flex justify-between items-center w-full p-2 text-left text-lime-300 bg-red-500 hover:bg-red-600 border border-b-0 border-gray-400 focus:ring-4 focus:ring-red-200"
                data-accordion-target="#accordion-body-<%= index %>" aria-expanded="false"
                aria-controls="accordion-body-<%= index %>">

                <div class="flex flex-col sm:flex-col sm:space-x-6 w-full">
                  <span class="w-full sm:w-1/4">
                    Platform: <%= todo.platform %>
                  </span>
                  <span class="w-full sm:w-1/4">
                    Course Name: <%= todo.course %>
                  </span>
                  <span class="w-full sm:w-1/4">
                    Trainer: <%= todo.name %>
                  </span>
                  <span class="w-full sm:w-1/4">
                    Enrolled Date: <%= todo.date %>
                  </span>
                </div>



                <svg data-accordion-icon class="w-6 h-6 shrink-0 transition-transform duration-200" aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </button>
              <form action="/delete/<%= todo._id %>?_method=DELETE" method="POST" style="display: inline;">
                <button type="submit"><i class="fa fa-trash-o"
                    style="font-size:24px;color:rgb(255, 255, 255)"></i></button>
              </form>
              <form action="/edit/<%= todo._id %>?_method=GET" method="POST" style="display: inline;">
                <button type="submit"><a href="#" data-tip="edit"><i class="fa fa-edit"></i></a></button>
              </form>

            </h2>
            <div id="accordion-body-<%= index %>" class="hidden" aria-labelledby="accordion-heading-<%= index %>">
              <div class="p-2 bg-purple-300 border border-gray-400 border-t-0">
                <%= todo.name %>
              </div>
            </div>
          </div>
          <% }) %>
      </div>
    </div>



  </div>
  <!-- ------------------------------------------------------------------------------------------------- -->
  <div class="row">
    <div class="col-md-12">
      <div class="accordion mb-2" id="accordionExample">
        <!-- Collapse one -->
        <div class="card">
          <div class="card-header " id="headingOne">
            <a class="accordion-icon" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false"
              aria-controls="collapseOne">
              <!-- main course loop -->

              <h5 class="py-2">

                <% todo.forEach((todo, index)=> { %>
                  <%= todo.course %> <span class="float-right"><i class="fas fa-angle-down"></i></span>
                    <form action="/edit/<%= todo._id %>?_method=GET" method="POST" style="display: inline;">
                      <button type="submit"><a href="#" data-tip="edit"><i class="fa fa-edit"></i></a></button>
                    </form>
              </h5>
              <h6><i>by <%=todo.name %></i> Date enrolled:<%= todo.date %>
              </h6>
              <h6>Status: <i style="color: #27e1ee;">In Progress</i></h6>
            </a>
            <section class="container  ">
              <form action="/addSubItem/<%= todo._id %> " method="POST" style="display: inline-flex;" class="">
                <div class="input-group mb-2 mr-sm-2 ">
                  <div class="input-group-prepend ">
                    <div class="input-group-text ">
                      <button type="submit"><i class="fa-solid fa-circle-plus fa-lg"
                          style="color: #365cd8;"></i></button>
                    </div>
                    <input type="text" class="questionnaire " name="subItem" required placeholder="Add Sub Item">
                  </div>
                </div>
              </form>
              <form action="/delete/<%= todo._id %>?_method=DELETE" method="POST" style="display: inline;">
                <button type="submit"><i class="fa fa-trash-o"
                    style="font-size:24px;color:rgb(255, 255, 255)"></i></button>
              </form>
            </section>
            <!-- collapse element [id="collapseOne" class="collapse"]-->
            <div id="" class="" aria-labelledby="headingOne" data-parent="#accordionExample">
              <!-- collapse element end-->
              <div class="card-body">
                <table class="table">
                  <thead>
                    <tr>
                      <th>#</th>
                      <th>Topic Name</th>
                      <th>Sub Topic</th>
                      <th>Completed (%)</th>
                      <th>edit</th>
                      <th>delete</th>
                      <th>Add Sub Topic</th>
                      <th>
                        <p>
                          <button class="btn btn-primary" type="button" data-toggle="collapse"
                            data-target="#collapseExample1" aria-expanded="false" aria-controls="collapseExample1"
                            id="collapse">
                            Expand
                          </button>
                        </p>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <!-- subItem loop -->
                      <%todo.subItems.forEach((subItem, subIndex)=> { %>
                        <td>
                          <%=subIndex+1 %>
                        </td>
                        <td class="font-weight-bold">
                          <%= subItem.text %>
                        </td>

                        <td>TBA</td>
                        <td>TBA</td>
                        <td>
                          <form action="/editSubItem/<%= todo._id %>/<%= subItem._id %>?_method=GET">
                            <button type="submit">
                              <li><a href="#" data-tip="edit"><i class="fa fa-edit"></i></a></li>
                            </button>
                          </form>
                        </td>
                        <td>
                          <form action="/deleteSubItem/<%= todo._id %>/<%= subItem._id %>?_method=DELETE" method="POST">
                            <button type="submit">
                              <li><a href="" data-tip="delete"><i class="fa fa-trash"></i></a></li>
                            </button>
                          </form>
                        </td>
                        <td colspan="2">
                          <form action="/addSubItem/<%= todo._id %>/addSubTopic" method="POST"
                            style="display: inline-flex;margin-bottom: 0;">
                            <input type="hidden" name="subItemIndex" value="<%= subIndex %>">
                            <input type="text" class="questionnaire" name="text" required placeholder="Add Sub Topic">
                            <button type="submit"><i class="fa-solid fa-circle-plus fa-lg"></i></button>
                          </form>
                        </td>
                        <td>

                        </td>
                    <tr>
                      <td colspan="8">
                        <!-- collapse element [class="collapse " id="collapseExample1"]-->
                        <div class=" " id="">
                          <!-- collapse end -->
                          <div class="card card-body">
                            <table class="table ">
                              <thead>
                                <th>check</th>
                                <th>#</th>
                                <th>SubTopic Title</th>
                                <th></th>
                              </thead>
                              <tbody>
                                <tr>
                                  <!-- subtopic loop -->
                                  <% subItem.subTopics.forEach((subTopic, subTopicIndex)=> { %>
                                    <td>
                                      <form
                                        action="/updateSubTopic/<%= todo._id %>/<%= subIndex %>/<%= subTopicIndex %>?_method=PUT"
                                        method="POST" style="display: inline;margin-bottom: 0;">
                                        <input type="checkbox" id="checkBox" <% if (subTopic.completed) { %>checked<% }
                                          %>
                                          onchange="this.form.submit()">
                                      </form>
                                    </td>
                                    <td class="<%= subTopic.completed ? 'completed' : '' %>">
                                      <%= subTopicIndex+1%>
                                    </td>
                                    <td class="<%= subTopic.completed ? 'completed' : '' %>">
                                      <%= subTopic.text %>
                                    </td>
                                    <td>
                                      <form
                                        action="/deleteSubTopic/<%= todo._id %>/<%= subIndex %>/<%= subTopicIndex %>?_method=DELETE"
                                        method="POST">
                                        <button type="submit">
                                          <li><a href="" data-tip="delete"><i class="fa fa-trash"></i></a></li>
                                        </button>
                                      </form>
                                    </td>
                                </tr>
                                <% }) %>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </td>
                    </tr>

                    </tr>
                    <% }) %>
                  </tbody>
                </table>
              </div>
            </div>
            <% }) %>
          </div>
        </div>
        <!-- Collapse one end-->
      </div>
    </div>
  </div>


  <!-- ------------------------------------------------------------------------------------------------- -->
  <%- include('layout/footer');%>